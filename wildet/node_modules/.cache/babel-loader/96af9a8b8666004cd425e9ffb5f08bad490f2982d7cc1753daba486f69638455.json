{"ast":null,"code":"import _slicedToArray from\"/Users/minjeongyeom/Projects/project-wildet/wildet/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useRef}from\"react\";import Webcam from\"react-webcam\";import axios from\"axios\";import Analysising from\"./Analysising\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function WebcamVideo(){var webcamRef=useRef(null);var mediaRecorderRef=useRef(null);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),recording=_useState2[0],setRecording=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),videoUrl=_useState4[0],setVideoUrl=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];var handleStartRecording=function handleStartRecording(){setRecording(true);mediaRecorderRef.current=new MediaRecorder(webcamRef.current.stream);mediaRecorderRef.current.addEventListener(\"dataavailable\",handleDataAvailable);mediaRecorderRef.current.start();};var handleDataAvailable=function handleDataAvailable(event){if(event.data.size>0){var videoBlob=new Blob([event.data],{type:\"video/mp4\"});var formData=new FormData();formData.append(\"file\",videoBlob);setIsLoading(true);axios.post(\"http://localhost:5000/detect\",formData,{headers:{\"Content-Type\":\"multipart/form-data\"},withCredentials:true,responseType:\"blob\"// blob 유형으로 응답 받음\n}).then(function(response){console.log(\"성공\");var videoBlob=new Blob([response.data],{type:\"video/mp4\"});setIsLoading(false);var videoUrl1=URL.createObjectURL(videoBlob);// URL 객체로 변환\nsetVideoUrl(videoUrl1);// const a = document.createElement(\"a\");\n// a.href = videoUrl1;\n// const videoName = `video_${new Date().getTime()}.mp4`;\n// a.download = videoName;\n// a.click();\n});}};console.log(videoUrl);var handleStopRecording=function handleStopRecording(){mediaRecorderRef.current.stop();};var videoConstraints={width:420,height:420,facingMode:\"user\"};// const handleVideoLoaded = (event) => {\n//   event.target.play();\n// };\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"Container\",children:isLoading?/*#__PURE__*/_jsx(\"div\",{style:{color:\"white\"},children:\"\\uAC1D\\uCCB4 \\uC778\\uC2DD \\uC911\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[videoUrl?/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){var a=document.createElement(\"a\");a.href=videoUrl;var videoName=\"video_\".concat(new Date().getTime(),\".mp4\");a.download=videoName;a.click();},children:\"\\uB2E4\\uC6B4\\uB85C\\uB4DC\"}):/*#__PURE__*/_jsx(Webcam,{height:400,width:400,audio:false,mirrored:true,ref:webcamRef,videoConstraints:videoConstraints}),recording?/*#__PURE__*/_jsx(\"button\",{onClick:handleStopRecording,children:\"Stop Recording\"}):/*#__PURE__*/_jsx(\"button\",{onClick:handleStartRecording,children:\"Start Recording\"})]})});}","map":{"version":3,"names":["React","useState","useRef","Webcam","axios","Analysising","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","WebcamVideo","webcamRef","mediaRecorderRef","_useState","_useState2","_slicedToArray","recording","setRecording","_useState3","_useState4","videoUrl","setVideoUrl","_useState5","_useState6","isLoading","setIsLoading","handleStartRecording","current","MediaRecorder","stream","addEventListener","handleDataAvailable","start","event","data","size","videoBlob","Blob","type","formData","FormData","append","post","headers","withCredentials","responseType","then","response","console","log","videoUrl1","URL","createObjectURL","handleStopRecording","stop","videoConstraints","width","height","facingMode","className","children","style","color","onClick","a","document","createElement","href","videoName","concat","Date","getTime","download","click","audio","mirrored","ref"],"sources":["/Users/minjeongyeom/Projects/project-wildet/wildet/src/components/WebcamVideo.jsx"],"sourcesContent":["import React, { useState, useRef } from \"react\";\nimport Webcam from \"react-webcam\";\nimport axios from \"axios\";\nimport Analysising from \"./Analysising\";\n\nexport default function WebcamVideo() {\n  const webcamRef = useRef(null);\n  const mediaRecorderRef = useRef(null);\n  const [recording, setRecording] = useState(false);\n  const [videoUrl, setVideoUrl] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n\n  const handleStartRecording = () => {\n    setRecording(true);\n    mediaRecorderRef.current = new MediaRecorder(webcamRef.current.stream);\n    mediaRecorderRef.current.addEventListener(\n      \"dataavailable\",\n      handleDataAvailable\n    );\n    mediaRecorderRef.current.start();\n  };\n\n  const handleDataAvailable = (event) => {\n    if (event.data.size > 0) {\n      const videoBlob = new Blob([event.data], { type: \"video/mp4\" });\n      const formData = new FormData();\n      formData.append(\"file\", videoBlob);\n      setIsLoading(true);\n      axios\n        .post(\"http://localhost:5000/detect\", formData, {\n          headers: {\n            \"Content-Type\": \"multipart/form-data\",\n          },\n          withCredentials: true,\n          responseType: \"blob\", // blob 유형으로 응답 받음\n        })\n        .then((response) => {\n          console.log(\"성공\");\n\n          const videoBlob = new Blob([response.data], {\n            type: \"video/mp4\",\n          });\n\n          setIsLoading(false);\n\n          const videoUrl1 = URL.createObjectURL(videoBlob); // URL 객체로 변환\n          setVideoUrl(videoUrl1);\n\n          // const a = document.createElement(\"a\");\n          // a.href = videoUrl1;\n          // const videoName = `video_${new Date().getTime()}.mp4`;\n          // a.download = videoName;\n          // a.click();\n        });\n    }\n  };\n\n  console.log(videoUrl);\n\n  const handleStopRecording = () => {\n    mediaRecorderRef.current.stop();\n  };\n\n  const videoConstraints = {\n    width: 420,\n    height: 420,\n    facingMode: \"user\",\n  };\n\n  // const handleVideoLoaded = (event) => {\n  //   event.target.play();\n  // };\n\n  return (\n    <div className=\"Container\">\n      {isLoading ? (\n        <div\n          style={{\n            color: \"white\",\n          }}\n        >\n          객체 인식 중\n        </div>\n      ) : (\n        <>\n          {videoUrl ? (\n            <button\n              onClick={() => {\n                const a = document.createElement(\"a\");\n                a.href = videoUrl;\n                const videoName = `video_${new Date().getTime()}.mp4`;\n                a.download = videoName;\n                a.click();\n              }}\n            >\n              다운로드\n            </button>\n          ) : (\n            <Webcam\n              height={400}\n              width={400}\n              audio={false}\n              mirrored={true}\n              ref={webcamRef}\n              videoConstraints={videoConstraints}\n            />\n          )}\n          {recording ? (\n            <button onClick={handleStopRecording}>Stop Recording</button>\n          ) : (\n            <button onClick={handleStartRecording}>Start Recording</button>\n          )}\n        </>\n      )}\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}